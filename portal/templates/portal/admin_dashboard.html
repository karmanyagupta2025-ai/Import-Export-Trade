{% extends 'portal/base.html' %}

{% block content %}
<div class="container py-4">
  <h2 class="mb-4">Admin Dashboard</h2>

  <div class="row mb-4 g-3">
    <!-- Summary Cards -->
    <div class="col-md-3">
      <div class="card border-primary shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <i class="bi bi-people fs-2 text-primary me-3"></i>
            <div>
              <h5 class="card-title mb-1">Total Clients</h5>
              <div class="fs-5 fw-bold">{{ total_clients|default:"175" }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-success shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <i class="bi bi-file-earmark-text fs-2 text-success me-3"></i>
            <div>
              <h5 class="card-title mb-1">Documents</h5>
              <div class="fs-5 fw-bold">{{ total_documents|default:"417" }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-info shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <i class="bi bi-truck fs-2 text-info me-3"></i>
            <div>
              <h5 class="card-title mb-1">Shipments</h5>
              <div class="fs-5 fw-bold">{{ total_shipments|default:"67" }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-warning shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center">
            <i class="bi bi-bar-chart-line fs-2 text-warning me-3"></i>
            <div>
              <h5 class="card-title mb-1">Revenue (USD)</h5>
              <div class="fs-5 fw-bold">${{ total_revenue|default:"85,900" }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">Quick Actions</div>
        <div class="card-body">
          <button class="btn btn-outline-primary mb-2 w-100">Add New Client</button>
          <button class="btn btn-outline-success mb-2 w-100">Upload Document</button>
          <button class="btn btn-outline-info mb-2 w-100">Track Shipments</button>
          <button class="btn btn-outline-dark w-100">Generate Report</button>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-success text-white">Live System Status</div>
        <div class="card-body">
          <div class="alert alert-success mb-2"><i class="bi bi-check-circle me-2"></i>All systems operational</div>
          <div class="alert alert-warning mb-0"><i class="bi bi-exclamation-triangle me-2"></i>No pending approvals</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Table -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-secondary text-white">Recent User Activity</div>
    <div class="card-body">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>User</th>
            <th>Action</th>
            <th>Date & Time</th>
          </tr>
        </thead>
        <tbody>
          {% for activity in recent_activities %}
          <tr>
            <td>{{ activity.user.username }}</td>
            <td>{{ activity.action }}</td>
            <td>{{ activity.timestamp|date:"Y-m-d h:i A" }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="3" class="text-center">No recent activity found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Charts Placeholder -->
  <div class="row g-3">
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-info text-white">Monthly Shipment Trends</div>
        <div class="card-body">
          <canvas id="shipmentChart"></canvas>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-warning text-dark">Revenue Breakdown</div>
        <div class="card-body">
          <canvas id="revenueChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Example Chart data for Shipments (replace with your dynamic data)
  const shipmentCtx = document.getElementById('shipmentChart').getContext('2d');
  const shipmentChart = new Chart(shipmentCtx, {
      type: 'line',
      data: {
          labels: {{ shipment_labels|safe }},
          datasets: [{
              label: 'Shipments Over Time',
              data: {{ shipment_data|safe }},
              borderColor: 'rgba(54, 162, 235, 1)',
              fill: false
          }]
      }
  });

  // Example Chart data for Revenue (replace with your dynamic data)
  const revenueCtx = document.getElementById('revenueChart').getContext('2d');
  const revenueChart = new Chart(revenueCtx, {
      type: 'bar',
      data: {
          labels: {{ revenue_labels|safe }},
          datasets: [{
              label: 'Monthly Revenue',
              data: {{ revenue_data|safe }},
              backgroundColor: 'rgba(255, 206, 86, 0.7)'
          }]
      }
  });
</script>
{% endblock %}
