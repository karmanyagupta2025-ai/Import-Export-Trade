{% extends 'portal/base.html' %}

{% block content %}
<div class="container py-4">
  <h2 class="mb-4">Admin Dashboard</h2>

<<<<<<< HEAD
=======
  <!-- Summary Cards Row -->
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
  <div class="row mb-4 g-3">
    <div class="col-md-3">
      <div class="card border-primary shadow-sm h-100">
        <div class="card-body text-center">
          <i class="bi bi-people fs-1 text-primary mb-2"></i>
          <h6 class="text-muted mb-1">Total Clients</h6>
          <h3 class="fw-bold mb-0">{{ total_clients|default:"175" }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-success shadow-sm h-100">
        <div class="card-body text-center">
          <i class="bi bi-file-earmark-text fs-1 text-success mb-2"></i>
          <h6 class="text-muted mb-1">Documents</h6>
          <h3 class="fw-bold mb-0">{{ total_documents|default:"417" }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-info shadow-sm h-100">
        <div class="card-body text-center">
          <i class="bi bi-truck fs-1 text-info mb-2"></i>
          <h6 class="text-muted mb-1">Shipments</h6>
          <h3 class="fw-bold mb-0">{{ total_shipments|default:"67" }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card border-warning shadow-sm h-100">
        <div class="card-body text-center">
          <i class="bi bi-bar-chart-line fs-1 text-warning mb-2"></i>
          <h6 class="text-muted mb-1">Revenue (USD)</h6>
          <h3 class="fw-bold mb-0">${{ total_revenue|default:"85,900" }}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions and System Status Row -->
  <div class="row mb-4 g-3">
    <div class="col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-primary text-white fw-bold">
          <i class="bi bi-lightning-charge me-2"></i>Quick Actions
        </div>
        <div class="card-body">
          <div class="d-grid gap-2">
            <a href="{% url 'signup' %}" class="btn btn-outline-primary">
              <i class="bi bi-person-plus me-2"></i>Add New Client
            </a>
            <a href="{% url 'document_upload' %}" class="btn btn-outline-success">
              <i class="bi bi-upload me-2"></i>Upload Document
            </a>
            <a href="{% url 'shipment_list' %}" class="btn btn-outline-info">
              <i class="bi bi-geo-alt me-2"></i>Track Shipments
            </a>
            <button class="btn btn-outline-dark" onclick="alert('Generate Report feature coming soon!')">
              <i class="bi bi-file-earmark-bar-graph me-2"></i>Generate Report
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-success text-white fw-bold">
          <i class="bi bi-activity me-2"></i>Live System Status
        </div>
        <div class="card-body">
          <div class="alert alert-success d-flex align-items-center mb-3">
            <i class="bi bi-check-circle-fill fs-5 me-3"></i>
            <div>
              <strong>All systems operational</strong>
              <small class="d-block text-muted">Last checked: Just now</small>
            </div>
          </div>
          <div class="alert alert-warning d-flex align-items-center mb-0">
            <i class="bi bi-exclamation-triangle-fill fs-5 me-3"></i>
            <div>
              <strong>No pending approvals</strong>
              <small class="d-block text-muted">All clear</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Table -->
  <div class="card shadow-sm mb-4">
<<<<<<< HEAD
    <div class="card-header bg-secondary text-white">Recent User Activity</div>
    <div class="card-body">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>User</th>
            <th>Action</th>
            <th>Date & Time</th>
          </tr>
        </thead>
        <tbody>
          {% for activity in recent_activities %}
          <tr>
            <td>{{ activity.user.username }}</td>
            <td>{{ activity.action }}</td>
            <td>{{ activity.timestamp|date:"Y-m-d h:i A" }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="3" class="text-center">No recent activity found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
=======
    <div class="card-header bg-secondary text-white fw-bold">
      <i class="bi bi-clock-history me-2"></i>Recent User Activity
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th class="px-4">User</th>
              <th>Action</th>
              <th>Date & Time</th>
            </tr>
          </thead>
          <tbody>
            {% for activity in recent_activities %}
            <tr>
              <td class="px-4">
                <i class="bi bi-person-circle me-2"></i>{{ activity.user.username }}
              </td>
              <td>{{ activity.action }}</td>
              <td class="text-muted">{{ activity.timestamp|date:"Y-m-d h:i A" }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="3" class="text-center text-muted py-4">
                <i class="bi bi-inbox fs-3 d-block mb-2"></i>
                No recent activity found.
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row g-3">
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-info text-white fw-bold">
          <i class="bi bi-graph-up me-2"></i>Monthly Shipment Trends
        </div>
        <div class="card-body">
<<<<<<< HEAD
          <canvas id="shipmentChart"></canvas>
=======
          <canvas id="shipmentChart" style="max-height: 300px;"></canvas>
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-header bg-warning text-dark fw-bold">
          <i class="bi bi-pie-chart me-2"></i>Revenue Breakdown
        </div>
        <div class="card-body">
<<<<<<< HEAD
          <canvas id="revenueChart"></canvas>
=======
          <canvas id="revenueChart" style="max-height: 300px;"></canvas>
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
        </div>
      </div>
    </div>
  </div>
</div>

<<<<<<< HEAD
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Example Chart data for Shipments (replace with your dynamic data)
=======
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Shipment Trends Chart
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
  const shipmentCtx = document.getElementById('shipmentChart').getContext('2d');
  const shipmentChart = new Chart(shipmentCtx, {
      type: 'line',
      data: {
          labels: {{ shipment_labels|safe }},
          datasets: [{
<<<<<<< HEAD
              label: 'Shipments Over Time',
              data: {{ shipment_data|safe }},
              borderColor: 'rgba(54, 162, 235, 1)',
              fill: false
          }]
      }
  });

  // Example Chart data for Revenue (replace with your dynamic data)
=======
              label: 'Shipments',
              data: {{ shipment_data|safe }},
              borderColor: 'rgba(13, 202, 240, 1)',
              backgroundColor: 'rgba(13, 202, 240, 0.1)',
              tension: 0.4,
              fill: true
          }]
      },
      options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
              legend: {
                  display: false
              }
          },
          scales: {
              y: {
                  beginAtZero: true
              }
          }
      }
  });

  // Revenue Breakdown Chart
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
  const revenueCtx = document.getElementById('revenueChart').getContext('2d');
  const revenueChart = new Chart(revenueCtx, {
      type: 'bar',
      data: {
          labels: {{ revenue_labels|safe }},
          datasets: [{
<<<<<<< HEAD
              label: 'Monthly Revenue',
              data: {{ revenue_data|safe }},
              backgroundColor: 'rgba(255, 206, 86, 0.7)'
          }]
=======
              label: 'Revenue (USD)',
              data: {{ revenue_data|safe }},
              backgroundColor: 'rgba(255, 193, 7, 0.7)',
              borderColor: 'rgba(255, 193, 7, 1)',
              borderWidth: 1
          }]
      },
      options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
              legend: {
                  display: false
              }
          },
          scales: {
              y: {
                  beginAtZero: true
              }
          }
>>>>>>> adda2ecc696c4646f2e36e20fa476b70546fa5e2
      }
  });
</script>
{% endblock %}
